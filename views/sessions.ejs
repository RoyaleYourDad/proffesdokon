<link rel="stylesheet" href="/css/tailwind.min.css">
<div class="min-h-screen text-white py-8 px-4 sm:px-6 lg:px-8" id="theme-root">
  <div class="max-w-5xl mx-auto">
    <!-- Theme Toggle -->
    <div class="flex justify-end mb-6">
      <button id="theme-toggle" class="p-2 rounded-full bg-gray-800 hover:bg-gray-700 transition-colors duration-300" aria-label="Toggle theme">
        <svg id="theme-icon" class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path>
        </svg>
      </button>
    </div>

    <!-- Main Card -->
    <div class="bg-gray-800/90 backdrop-blur-md rounded-2xl shadow-2xl p-6 sm:p-8 border border-gray-700/50 transition-all duration-500 hover:shadow-indigo-500/20">
      <h1 class="text-3xl sm:text-4xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-indigo-400 to-pink-600 mb-4 animate-pulse-slow">Session Files</h1>
      <p class="text-gray-300 mb-6 text-base sm:text-lg">Directory: <span class="font-mono text-indigo-400"><%= sessionPath %></span></p>

      <% if (sessionFiles.length === 0) { %>
        <div class="text-center py-12">
          <p class="text-gray-400 text-lg sm:text-xl animate-fade-in">No session files found.</p>
          <a href="/" class="mt-4 inline-block px-6 py-3 bg-indigo-600 text-white rounded-full hover:bg-indigo-700 transition-transform duration-300 transform hover:scale-105 text-sm sm:text-base">Back to Home</a>
        </div>
      <% } else { %>
        <div class="overflow-x-auto">
          <table class="min-w-full divide-y divide-gray-700">
            <thead>
              <tr>
                <th class="py-3 px-4 text-left text-xs sm:text-sm font-semibold text-gray-300">File Name</th>
                <th class="py-3 px-4 text-left text-xs sm:text-sm font-semibold text-gray-300">Size</th>
                <th class="py-3 px-4 text-left text-xs sm:text-sm font-semibold text-gray-300 hidden sm:table-cell">Last Modified</th>
                <th class="py-3 px-4 text-left text-xs sm:text-sm font-semibold text-gray-300">Actions</th>
              </tr>
            </thead>
            <tbody class="divide-y divide-gray-700">
              <% sessionFiles.forEach(file => { %>
                <tr class="hover:bg-gray-700/50 transition-colors duration-200 animate-fade-in">
                  <td class="py-3 px-4 text-sm">
                    <a href="/sessions/<%= file.name %>" class="text-indigo-400 hover:text-indigo-300 transition-colors duration-200 font-medium break-all">
                      <%= file.name %>
                    </a>
                  </td>
                  <td class="py-3 px-4 text-sm text-gray-300"><%= file.stats.size %></td>
                  <td class="py-3 px-4 text-sm text-gray-300 hidden sm:table-cell"><%= file.stats.mtime.toLocaleString() %></td>
                  <td class="py-3 px-4">
                    <a
                      href="/sessions/<%= file.name %>?download=true"
                      class="inline-flex items-center px-3 py-1.5 bg-gradient-to-r from-indigo-600 to-purple-600 text-white rounded-full hover:from-indigo-700 hover:to-purple-700 transition-all duration-300 transform hover:scale-105 shadow-md text-sm"
                    >
                      <svg class="w-4 h-4 mr-1 sm:mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path>
                      </svg>
                      <span class="hidden sm:inline">Download</span>
                      <span class="sm:hidden">DL</span>
                    </a>
                  </td>
                </tr>
              <% }) %>
            </tbody>
          </table>
        </div>
      <% } %>

      <div class="mt-6 sm:mt-8">
        <a href="/" class="inline-flex items-center px-6 py-3 bg-gradient-to-r from-indigo-600 to-purple-600 text-white rounded-full hover:from-indigo-700 hover:to-purple-700 transition-all duration-300 transform hover:scale-105 shadow-md text-sm sm:text-base">
          <svg class="w-4 h-4 mr-1 sm:w-5 sm:h-5 sm:mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
          </svg>
          Back to Home
        </a>
      </div>
    </div>
  </div>
</div>

<!-- Theme Styles -->
<style>
  :root {
    --card-bg: rgba(31, 41, 55, 0.9);
    --text-color: #e5e7eb;
    --text-muted: #9ca3af;
    --border-color: rgba(55, 65, 81, 0.5);
    --hover-bg: rgba(55, 65, 81, 0.5);
    --shadow-color: rgba(99, 102, 241, 0.2);
  }

  [data-theme="light"] {
    --card-bg: rgba(255, 255, 255, 0.95);
    --text-color: #1f2937;
    --text-muted: #6b7280;
    --border-color: rgba(209, 213, 219, 0.5);
    --hover-bg: rgba(243, 244, 246, 0.5);
    --shadow-color: rgba(99, 102, 241, 0.1);
  }

  #theme-root[data-theme="dark"] {
    background: linear-gradient(to bottom right, #1a1a2e, #312e81, #1a1a2e);
  }

  #theme-root[data-theme="light"] {
    background: linear-gradient(to bottom right, #f3f4f6, #e0e7ff, #f3f4f6);
  }

  #theme-root .bg-gray-800\/90 {
    background: var(--card-bg);
    border-color: var(--border-color);
  }

  #theme-root .text-gray-300 {
    color: var(--text-color);
  }

  #theme-root .text-gray-400 {
    color: var(--text-muted);
  }

  #theme-root .divide-gray-700 {
    border-color: var(--border-color);
  }

  #theme-root .hover\:bg-gray-700\/50:hover {
    background: var(--hover-bg);
  }

  #theme-root .hover\:shadow-indigo-500\/20:hover {
    box-shadow: 0 10px 15px -3px var(--shadow-color);
  }

  .animate-pulse-slow {
    animation: pulse 6s cubic-bezier(0.4, 0, 0.6, 1) infinite;
  }

  .animate-fade-in {
    animation: fadeIn 0.5s ease-in-out;
  }

  @keyframes pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.7; }
  }

  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
  }
</style>

<!-- Theme Toggle Script -->
<script>
  const toggleButton = document.getElementById('theme-toggle');
  const themeIcon = document.getElementById('theme-icon');
  const themeRoot = document.getElementById('theme-root');

  // Check for saved theme preference or default to dark
  const savedTheme = localStorage.getItem('theme') || 'dark';
  themeRoot.setAttribute('data-theme', savedTheme);
  if (savedTheme === 'light') {
    themeIcon.querySelector('path').setAttribute('d', 'M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z');
  }

  toggleButton.addEventListener('click', () => {
    const currentTheme = themeRoot.getAttribute('data-theme');
    const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
    themeRoot.setAttribute('data-theme', newTheme);
    localStorage.setItem('theme', newTheme);

    // Update icon
    themeIcon.querySelector('path').setAttribute('d', 
      newTheme === 'dark' 
        ? 'M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z'
        : 'M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z'
    );
  });
</script>